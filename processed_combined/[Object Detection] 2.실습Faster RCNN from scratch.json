{
  "lecture_name": "[Object Detection] 2.실습Faster RCNN from scratch",
  "source_file": "[Object Detection] 2.실습Faster RCNN from scratch_115.mp4_2025-12-04-104630404.json",
  "text": "네 안녕하세요. 이번에는 저희가 2강에서 배운 패스트 RCNN에 대해서 프롬 스크래치를 한번 구현해 보는 시간을 갖도록 하겠습니다. 네 먼저 라이브러리 정보는 다음과 같습니다. 뭐 다 비슷하고 특이한 점으로는 그냥 어로멘테이션 라이브러리를 사용했다. 그 외에는 거의 다 기본 정보랑 비슷합니다. 그다음에 저희가 이제 데이터 셋 하이퍼 파라미터 세팅부터 살펴볼 건데요. 러닝 레잇은 다음과 같이 적고 러닝 레이디케 lr 이 비율로 이제 줄일 거고 웨이트 디케 그다음에 뭐 기타 정보 다음과 같고요. 그다음에 총 14회 폭을 사용을 했고 뭐 이렇게 패스는 다음과 같습니다. 먼저 이제 데이터 불러오는 모듈부터 같이 설명드릴 텐데요. 먼저 이제 커스텀 데이터 셋을 저희가 만들어서 저희 재활용 데이터 셋을 로드를 할 수 있게끔 이런 데이터 클래스에 대해서 제공을 해 드렸습니다. 보시면은 먼저 이제 코코 API 사용해서 코코 정의하고요. 어노테이션 파일을 이제 읽을 수 있게끔 그 코코 정의하고요. 아래 과정은 다음과 같고 그다음에 이 정의된 코코로부터 이미지 아이디 불러오고 이미지 정보 불러와서 실제로 이렇게 이미지를 로드를 해주시면 됩니다. 그다음에 25로 나눠서 노멀라이즈 해주고요. 어노테이션 파일도 다음과 같이 로드를 할 수 있고 그다음에 박스 가져오고 박스를 스면 와인 스 맥스 와 맥스 포맷으로 바꿔주게 됩니다. 그다음에 레이블도 가져오고 트랜스폼 이렇게 호출하면서 최종적으로 트랜스폼 된 이미지와 바운딩 박스를 가져오면 됩니다. 어버멘테이션 트랜스폼이 되게 재밌는 점이 뭐냐면은 저희가 이미지에 어떤 트랜스폼을 가하게 되잖아요. 근데 이미지의 트랜스폼의 결과로 인해서 바운팅 박스의 위치 정보나 또는 존재 여부를 바꿔줘야 될 그런 경우가 있거든요. 예를 들어서 저희가 어떤 컷 아웃 트랜스폼을 사용을 했는데 컷 아웃이 박스를 없애버릴 수도 있잖아요. 그렇게 되면은 바운딩 박스 레이블에서 저희가 그거를 반영을 해 줘야 되는데 그것을 직접 하나하나 하기에는 약간 어느 정도 코딩을 좀 해야 될 게 좀 생깁니다. 그 과정을 이제 어그멘테이션 같은 경우는 자동으로 해주기 때문에 이 디텍션 테스크를 수행하면서 얼버멘테이션 라이브러리가 주는 이점이 정말 큽니다. 그래서 최종적으로는 그런 것까지 이제 반영된 여기 박스 정보가 다음과 같고요. 그래서 이제 계산의 편의성을 위해서 스미 와 민 스맥스 와 맥스 형태를 와 미 스미 와 맥스 엑스맥스 형태로 바꿔주게 됩니다. 그래서 이제 커스텀 데이터에서 이렇게 바뀐 이미지 박스 레이블을 리턴을 해 주게 됩니다. 그래서 이제 트랜스폼을 보면은 얼버멘테이션 트랜스폼인데 아까 말씀드렸다시피 여기에 박스 파람을 넣어주게 되면은 박스도 같이 고려를 하게 됩니다. 그래서 이제 저희가 파스카보 포맷의 박스인지 아니면은 코코 기반의 박스인지 그런 정보를 같이 넘겨주게 되고요. 그다음에 레이블로 볼 필드는 무엇인지 레이블 정보를 이제 같이 넘겨주면은 박스 바람 박스까지 같이 어그멘테이션 할 수 있습니다. 밸리데이션도 마찬가지고요. 그다음에 앞서 정의한 이 커스텀 데이터 셋으로 트레인 데이터 셋, 엘리드 데이터 셋, 테스트 데이터 셋을 정해서 사용할 수 있게끔 합니다. 뭐 세 가지 차이점이라고 하면은 그냥 어노테이션 파일의 위치와 그 트랜스폼에 대한 차이들이 있겠죠. 이제 필요한 것은 데이터셋을 로드하면은 저희가 이제 데이터 셋이 백번 과정을 거쳐서 그 백번으로부터 피처 맵이 생기게 되고 그 피처 맵을 이제 알큐엔에 통보를 해 주잖아요. 그래서 이제 먼저 백번부터 한번 살펴보도록 하겠습니다. 저희 같은 경우는 이제 브지 16 백랫폼을 사용했고요. 브지 16 모델을 로드를 해서 이것은 이제 토치 비전에서 제공해 주는 브지 16 모델입니다. 그 모델로부터 최종적으로 이 피처 맵을 계산을 해 드리면 됩니다. 그렇게 해서 얻어진 피처 맵이 어 알피엔 네트워크를 이제 통과를 해서 최종적으로는 2천 개의 리존 프로포절들에 대해서 예측을 하게 되잖아요. 근데 그 2천 개의 리중 프로포절들에 대해서 예측하는 과정이 그렇게 엄청 간단하지는 않았습니다. 다시 한번 리뷰를 해보자면은 피처 맵에서 기본 베이스 앵커 박스들을 각 픽셀별로 생성을 해내고요. 그다음에 그렇게 만들어진 베이스 앵커 박스가 엄청나게 많은데 그 엄청나게 많은 것들을 어느 정도 걸러내 주기 위해서 각 앵커 박스에 대해서 스코어를 계산을 해 줬어야 됐고 그다음에 각 베이스 앵커 박스들에 대해서 그 위치 미세 조정할 위치를 계산을 해줘야 됐습니다. 그 위치 정보라고 하면은 뭐 스 좌표를 어느 정도로 옮길 것이며 위스타 헤이트를 어느 정도로 옮길지 그 델타를 같이 계산을 해 줬어야 됐습니다. 그렇게 됐을 때 최종적으로는 스코어 기준으로 n개를 잘라서 그 n개를 저희가 이제 리존 프로포절로 활용을 하고 그 NG에 대해서 알아 프로젝션 이후 헤드 네트워크에 통과한다라고 보시면 되겠습니다. 그 과정을 이제 지금 여기 앵커 박스 생성하는 거 프로포절 생성하는 거 그리고 최종적으로 이제 알피엔 정의하는 거 그 부분에 대해서 설명드리도록 하겠습니다. 먼저 이제 앵커 박스인데요. 앵커 박스 같은 경우는 되게 간단하죠. 이제 앵커 박스 같은 경우는 베이스 앵커 박스이기 때문에 한 픽셀 당 총 몇 개의 앵커 박스가 생성되냐 그게 이제 이 제너레이트 앵커 베이스 의 역할입니다. 그래서 레시오와 스케일 정보를 가지고 각 픽셀별로 이제 베이스 앵커 박스들을 만들어 내면 됩니다. 이제 만들어내는 과정이 다음과 같고 최종적으로 앵커 박스의 쉐입을 살펴보면 다음과 같이 9콤마 4로 만들어질 수가 있습니다. 그래서 이제 베이스 사이즈 앵커 박스의 베이스 사이즈로부터 뭐 이렇게 쭉 계산을 앵커 박스를 만들어내게 되고요. 그다음에 이제 저희가 다음에 필요할 것은 이 앵커 박스의 위치를 미세 조정하는 그 정보와 박스 정보와 그다음에 앵커 박스를 걸러낼 수가 있는 앵커 박스의 스코어 정보, 스코어 정보로 스코어 정보로부터 앵커 박스를 이제 필터 하는 과정을 이제 여기 프로포절 크리에이터가 한다고 보시면 되겠습니다. 다시 말해서 RPN에서 구한 정보와 앵커 박스에서 구한 정보로 최종적으로 이제 줄어든 필터 된 ROI를 만들어 낸다라고 보시면 되겠습니다. 그래서 이제 이 필터 하는 과정에서는 저희가 강의에서 설명했던 것보다 어느 정도 좀 더 복잡을 한데요. 좀 더 이제 구체적으로 보자면은 최종 이제 엄청나게 많은 앵커 박스들 중에서 저희가 그냥 스코어로 바로 2천 개 필터 한다라고 했었는데 사실은 스코어로 바로 필터 하는 게 아니라 스코어로 한 이 정도 필터 하고 그다음에 NMS 과정 이후에 2천 개를 필터 한다라고 보시면 되겠습니다. 그러니까 그 사이에 NMS라는 과정이 사실은 껴 있습니다. 그렇게 이제 최종적으로는 2천 개를 리턴을 해 주게 되고요. 그래서 이 프로포절 크레에이터가 어떤 식으로 작동하는지 같이 한번 살펴보자면 여기에 이제 앵커 박스가 있겠죠. 각 픽셀별로 앵커 박스 9개씩 할당된 앵커 박스 정보들 엄청나게 많은 앵커 박스들이 있을 거고요. 그 앵커 박스의 위치를 미세 조정할 로컬리제이션 정보 그다음에 그 앵커 박스의 스코어 박스 옆 오브젝트 객체를 담고 있는 그 스코어 이제 벡터가 있을 것입니다. 저희가 할 일은 앵커 박스의 위치를 미세 조정하고 여기 이제 미세 조정해줬죠. 미세 조정한 것을 스코어 기준으로 잘라내면 됩니다. 이 부분이 이제 잘라내는 부분이고 그렇게 해서 잘라냈을 때 사실은 NMS 과정이 여기 하나 더 들어가기 때문에 잘라내고 NMS 적용해서 최종적으로는 2천 개만 사용한다라고 보시면 되겠습니다. 그렇게 해서 이 ROI가 이렇게 나오게 되는 것이죠. 이 과정을 이제 알피엔 네트워크에서 어떤 식으로 수행하는지 한번 보도록 하겠는데요. 알피엠 네트워크를 보시면은 먼저 피처 정보를 봤죠. 알피엔 네트워크가 하는 일은 VGG를 통과한 피처 맵으로부터 리전 프로포절들을 생성해내는 건데요. 저희가 앞서 배운 이 모든 과정을 그냥 하나로 묶어 놓은 그런 새로운 클래스가 되겠습니다. 그래서 먼저 이제 보시면은 여기 그러니까 결론적으로는 RPN이 해야 될 것은 베이스 앵커 박스의 위치를 어느 정도로 바꿀지 미세 조정하는 벡터를 크리에이트 해야 되고요. 그다음에 각 앵커 박스별로 스코어가 어떻게 될지 그 스코어를 계산해내는 벡터를 크리에이트 해야 됩니다. 그래서 이제 그 크리에이트 하는 과정이 여기 이 코드 셋에 담겨져 있고 보시면은 스코어 콤블루션 로컬리제이션 콤블루션을 수행을 하죠. 그래서 스코어 콤블루션을 수행을 할 때는 보시면은 9 곱하기 2 그래서 클래스가 오브젝트를 포함하고 있냐 안 하고 있냐 정보고요. 로컬리제이션 같은 경우는 9 곱하기 4 그래서 그 앵커 박스의 위치를 어느 정도로 미세 조정할 것이냐 그 부분입니다. 이제 포워드 과정에서는 이제 베이스 앵커 박스를 전체 픽셀에 확장을 하고요. 이렇게 확장을 해 주고 각 픽셀별로 바운딩 박스 오프셋 계산을 해 주고 그다음에 각 픽셀별로 스코어 오프셋을 계산을 해 주게 됩니다. 그다음에 요 객체와 이 객체를 이렇게 저희가 앵커 박스 포맷에 맞게 리사이즈를 이렇게 해주게 됩니다. 리쉐입을 해주게 됩니다. 그렇게 되면 최종적으로는 rp엔 스코어스에는 각 앵커 박스가 객체를 어느 정도로 포함하고 있냐 그 점수를 담고 있고요. 알피엔 록에는 각 앵커 박스가 그 위치를 어느 정도로 미세 조정해 줘야 되냐 그 정보를 이렇게 담고 있습니다. 최종적으로는 이 알피엔 록 알피엔 스쿼스 그다음에 앵커 박스를 그 프로포절 네트워크 아까 앞서 봤던 프로포절 네트워크에 넣어주면은 최종적으로는 그 2천 개의 ROI가 나오게 됩니다. 그래서 이제 리존 프로포절에서는 그냥 그 2천 개의 ROI에 대해서 리턴을 해 주면 되겠죠. 그래서 이렇게 ROI 2천 개의 ROI를 배치별로 묶어가지고 리턴해주는 모습을 보실 수가 있습니다. 이 부분은 저희가 정리했던 부분이고요. 그렇게 해서 이제 RPM까지 최종적으로 마무리가 됐다 라고 보시면 될 것 같고 이제 남은 것은 RPN 적게 됐으니까 패스트 라이시에는 이제 정리해야겠죠. 그전에 RPN 통과한 ROI들로부터 저희가 최종적으로는 클래스와 박스 위치를 한 번 더 예측을 해 주게 되잖아요. 그 부분이 이제 이 패스트 icn의 헤드 헤드 부분이라고 보시면 되겠습니다. 그 헤드 부분에 대한 최종 목표는 RPN으로부터 나온 ROI를 받아서 ROI를 풀링하고 프로젝션은 풀링하고 그 풀링된 고정된 피처 벡터로부터 클래스 예측하고 그다음에 정확한 박스 예측하고 그 부분이라고 보시면 되겠습니다. 리그를 하네요. 네 그래서 여기 보시면은 이제 그 이닛 같은 경우는 클래스 개수나 ROI 사이즈나 이런 것들이 이렇게 들어가 주게 되고 ROI 사이즈 같은 경우는 저희가 알아 플링할 때 타겟 사이즈를 정하잖아요. 네 그래서 타겟 사이즈별로 비닝해서 거기서부터 이제 플링을 진행하기 때문에 그 타겟 사이즈라고 보시면 되겠습니다. 보워드 과정 보시면은 피처 맵과 RPM 결과 나와 ROI가 나오게 되죠. 피처 맵과 ROI들로부터 이제 플링을 진행을 하게 되는데 여기 보시면은 셀프 ROI 해서 일단 먼저 풀링을 하고요. 셀프 ROI 보시면은 이 부분 ROI 풀이라는 함수가 있죠. 이거는 이제 토치비전에서 제공해 주는 함수입니다. TC 비전에서 제공해 주는 함수라서 프로젝션까지 여기서 같이 진행을 해주기 때문에 저희가 가져와서 사용을 했습니다. 그래서 실제로 이렇게 ROI 풀 해주고 클렛 결과 이렇게 고정된 고정된 사이즈를 갖게 되죠. 이제 고정된 사이즈의 피처 벡터를 플랫을 해줘서 최종적으로 이제 클래시 파이어 통과해서 4.96의 피처를 갖게 되고 이걸로부터 이제 리그레이션과 어 소프트맥스 클래시 파이어를 시행하게 되는데 리그레이션 같은 경우는 다 이렇게 그다음에 소프트맥스 결과는 다음과 같은 이제 쉐입을 갖게 됩니다. 이제 최종적으로는 이렇게 그 스코어 박스 정보와 그다음에 클래스 정보가 리턴되게 됩니다. 어 이런 이제 ROI 헤드까지 저희가 정의해 봤으니까 맨 마지막에 이제 패스트 라 시엔을 정의를 해 낼 수가 있는데요. 패스트라 시엔 같은 경우는 되게 간단하죠. 먼저 지금까지의 정보를 그냥 지금까지 선언했던 클래스를 그냥 통합해 주면 됩니다. 그래서 피처 익스트랙션으로부터 그걸 알피엔에 넘겨주고 알피n으로부터 ROI가 나오게 될 텐데 그 ROI부터 로컬리제이션과 클래시피케이션 헤드를 통과해 주는 그런 그런 이제 연결을 여기서 이제 담당해 주면 됩니다. 그래서 이제 패스트 CNN 정리된 거 보면은 다음과 같이 이입 과정에서 익스트랙터 선언하고 저희가 앞서 배운 RPN 선언하고 헤드 클래스 생성해내서 최종적으로 포워드 과정에서 익스트랙터에서 나온 거를 알피엔에 넘겨주고 그러니까 피처 맵을 알피엔에 넘겨주고 그러면 알피엔 같은 경우는 알로아를 리턴하게 될 텐데 그 ROI를 헤드 통과해 주셔서 최종적인 클래스 정보와 로컬리에이션 정보를 리턴한다라고 보시면 되겠습니다. 그래서 저희가 최종적으로는 이제 이 베스트 아이시에서는 이런 이런 절차를 갖게 되고요. 그다음에 저희가 이제 백번 같은 경우 VG 16을 사용하잖아요. 그래서 이제 이렇게 익스트랙터를 구체적으로 정의하고 RPN 어떤 RPN인지 구체적으로 정의하고 어떤 헤드인지 구체적으로 정의해서 이 패스트 아이스는 상속받았기 때문에 그거를 이제 슈퍼 슈퍼를 통해서 익스트랙트 알피 헤드를 넘겨주게 되면은 저희가 최종적으로 이 클래스를 활용하게 되면은 VG 16 피처맵으로부터 이제 RPM과 ROI를 뽑아내는 패스트 RCNN을 정의해 낼 수 있게 됩니다. 이제 트레이너 함수를 보면은 먼저 이제 트레이너를 정의해야 되는데요. 저희가 이렇게 모델만 정의를 해서는 실제 학습을 할 수가 없습니다. 즉 학습하기 위해서 데이터셋을 만들어내는 그 트레이너도 같이 정의를 해줘야 되는데요. 그 말은 즉슨 RPN도 트레인 해줘야 되고 제가 저희가 최종적으로 ROI 헤드 부분도 트레인을 해줬어야 되잖아요. 그래서 알피엔 트레이닝 해 주기 위해서 이제 여러 프로포절들 중에서 막 아이유가 특정 이상인 애들을 파시티브로 특정 이하인 애들을 negative로 그런 식으로 이제 저희가 트레 셋을 정의를 해줬었는데 그 부분이 이제 여기 앵커 타겟 크리에이터와 이 프로포절 타겟 크리에이터 이 두 가지 크리에이터라고 보시면 되겠습니다. 그래서 이제 앵커 타겟 크리에이터의 역할은 RPN을 트레이닝 시켜주는 애들인데요. 그래서 이제 앵커 박스에 해당하는 그라운드 트로스 바운딩 박스를 이제 매치시켜 줘야 됩니다. 그래서 앵커 박스로부터 어떤 앵커 박스들이 positive 샘플이며 어떤 앵커 박스들이 이제 negative 샘플인지 계산을 해줘야 됩니다. 그 과정을 보시면은 총 앵커 박스들을 가져와서 먼저 앵커 박스들로부터 이제 그 인사이드에 있는 앵커 박스들을 가져와야 됩니다. 그러니까 예를 들어서 피처가 0 b이 0인 애들은 그 이미지를 앵커 박스가 이미지를 벗어나게 되잖아요. 위쪽과 왼쪽에 그렇게 이제 벗어나게 된 앵커 박스를 제외한 나머지 앵커 박스들만 가져오게 돼서 그 앵커 박스들로부터 그라운드 트로스와 아이유를 계산을 해서 어 최종적으로 이제 positive 샘플과 negative 샘플을 만들어 낸다라고 보시면 되겠습니다. 그래서 이제 이 부분에 이제 파이스티브 샘플과 negative 샘플을 만들어내는 부분이고요. 그리고 먼저 이제 negative 샘플 같은 경우는 0.3 이하인 그 박스들은 다 negative 샘플로 저희가 봤었죠. 그다음 positive 샘플은 그라운드 트루스가 가장 큰 아이를 가지고 있는 애 하나와 그다음에 아이유가 0.7 이상인 그런 박스를 저희가 이제 파시티브 샘플로 구성을 했었습니다. 이런 식으로 이제 박스를 구성을 하는 것을 앵커 타겟 크리에이터라고 보시면 되겠습니다. 그다음에 이제 남은 것은 알오아 헤드를 학습하기 위해서 ROI 헤드도 그 데이터 샘플을 파시티브 샘플과 알로아이드를 파시티브 샘플과 negative 샘플로 이렇게 나눠줬어야 됐잖아요 이제 그 부분이 여기 프로포절 타겟 네트 타겟 크리에이터라고 보시면 되겠습니다. 구체적인 과정은 저희가 주석을 달아놨기 때문에 한번 이렇게 쭉 살펴보시면 될 것 같습니다. 이제 positive 샘플 고르는 방법 이렇게 negative 샘플 고르는 방법 해서 최종적으로 128 배치를 리턴을 해 준다라고 보시면 되겠습니다. 이렇게 이제 저희가 학습을 위해서 데이터셋을 구성을 하는 트레이너도 정의를 했으니까 최종적으로 이제 패스트 RCNN 트레이너에 대해서 정의를 할 수가 있는데요. 이 부분에는 이제 로스와 관련된 부분들이 있겠죠 그래서 먼저 RPN 로스 2개 그다음에 ROI 로스 2개 에 대해서 저희가 이제 로스를 계산을 하고 백워드를 진행을 해줘야 됩니다. 여기 이제 앵커 크리에이터 정의하고 프로포즈 크리에이트 정의하고 최종적으로 여기 포워드 과정에서 알피엔 결과와 그다음에 프로포절 과정에서 나온 결과를 가지고 여기에 이제 이 부분에 이제 알피엔 로스를 계산을 하고 이 부분에 이제 ROI 로스를 계산을 하는데요. 먼저 이제 알피엔 로스 같은 경우는 음 이렇게 이제 로컬리제이션 로스와 클래시피케이션 로스로 알피엔 로스를 계산을 하고요. ROI 로스도 마찬가지로 로컬리제이션 로스와 그다음에 크로스 엔트로피 로스로 클래시피케이션 로스를 이렇게 계산을 해내게 됩니다. 그럼 최종적으로 알피엔 로스 알피엔 로스 2개 그다음에 ROI 로스 2개가 나오게 되죠. 그렇게 이제 이 로스를 통합을 해줘서 얘를 이제 서메이션해서 로스 투플로 구성을 해주고 이 트레이닝 스텝에서 이 로스에 대해서 이제 백워드를 해주면 됩니다. 그렇게 해서 최종적으로 알피엔과 그 알아를 ROI에 대해서 모델 웨이트를 이제 저희가 업데이트를 해줄 수가 있습니다. 네 그래서 이제 로컬리제이션 로스가 이렇게 생겼고 그 스모스 에러 노스는 이렇게 생겼고 위에 크로스 앤트로피 로스 이런 거 저희가 이제 사용을 했습니다. 이렇게 이제 최종적으로 패스트 RCN는 트레이너까지 정의가 되어 있으니까 저희가 학습을 진행을 해 주면 되는데요. 학습 같은 경우는 데이터셋 불러오고 그다음에 여기에 트레이너 불러와서 트레이너가 패스트 신의 트레이너 여기 트레이너 불러오고 이 트레이너로부터 여기 트레잉 스텝 과정 거쳐서 실질적으로 그 패스트 icn에 대해서 이 패스트 icn의 v7 16 저희가 선언한 이 부분이죠. 이 모델에 대해서 트레이닝을 진행을 해 주시면 됩니다. 이 트레이 호출하면 수행 가능하고 인플루언서도 이제 마찬가지로 최종적으로 이제 서브미션 포맷으로 저장할 수 있는 인플런스 파일 이렇게 다음과 같습니다. 어 이거 이제 저희가 사용할 레퍼런스는 다음과 같고 우리 캠퍼분들께서는 각각 트레이너에서 벡터들이 어떤 모습을 갖는지 각각 중간중간에 어떤 의미를 갖는지 저희가 옆에 이렇게 주석으로 다 달아드렸거든요. 그래서 실제로 한번 이 한 줄 한 줄 실행을 시켜보면서 각 모듈 하나하나 이제 실행을 시켜 보면서 어 이 코드 크롬 스크래치 코드에 대해서 학습해 보시는 것을 추천드립니다. 최종 정리 드리자면요. 이제 베스트 RCNN 같은 경우는 백 번 통과해서 피처 맵이 나오잖아요. 백 번 통과해서 피처 맵이 나오는 게 요 피처 익스트랙터라고 보시면 될 것 같고요. 그렇게 나온 이제 피처 맵이 알피엠 네트워크에 통과해서 ROI들을 뽑아내야 되잖아요. 그 과정이 이 리전 프로포절 네트워크 이 부분이라고 보시면 되겠습니다. 근데 이제 알피엠 과정은 단순하게 그냥 ROI를 뽑아낸다가 아니라 약간 복잡한 부분이 있는데 먼저 이제 피처 맵으로부터 베이스 앵커 박스를 생성을 내야 되고 그 베이스 앵커 박스들의 위치를 미세 조정하고 각 베이스 앵커 박스로부터 n개를 걸러내서 최종적으로는 그 n개의 ROI를 저희가 활용하는데 그 베이스 앵커 박스 만들어내는 과정이 이 부분이 될 것이고 그다음에 베이스 앵커 박스에 대한 미세 조정할 위치와 그 베이스 앵커 박스를 평가할 스코어를 예측하는 부분이 이 부분이 될 것이고 이거를 반영하는 부분이 이 프로포절이 될 것입니다. 그렇게 해서 이제 최종적으로는 RPN을 통과하게 되면은 2천 개의 ROI가 나오게 될 것입니다. 이제 남은 것은 그 2천 개의 ROI를 원래 피처 맵이 프로젝션 시켜서 최종 로컬리제이션 헤드와 클래시피케이션 헤드를 통과해 주면 되는데요. 그 부분이 이제 이 부분에 담겨 있습니다. 그래서 ROI 풀링 후에 클래시피케이션 헤드 통과하고 로컬 션 통과한다라고 보시면 될 것 같고 이것을 이제 최종적으로 패스트 아이씨에 이렇게 정리해 낼 수가 있습니다. 그다음에 이제 저희가 필요한 것은 인퍼런스 과정은 이 모델들만 있으면 되지만 저희가 실제로 학습을 진행을 해야 되잖아요. 학습을 하기 위해서는 알피엔과 그 헤드를 학습을 해야 되는데 알피엔 학습을 위해서는 이제 앵커 타겟 크리에이터 요 클래스가 필요하고요. 그다음에 헤드 네트워크를 학습하기 위해서는 프로포절 타겟 크리에이터 클래스가 필요합니다. 그래서 이제 각각 크리에이터가 하는 역할은 리준 프로포절들을 파시티브 샘플과 negative 샘플로 나눠서 학습을 시행할 수 있게끔 만들어 주고요. 그다음에 ROI 헤드를 학습하기 위해서는 알로아드를 파이스티브 샘플과 negative 샘플로 나눠서 학습을 수행할 수 있게끔 해줍니다. 이렇게 이제 최종적으로 데이터 셋을 뽑아내는 크리에이터까지 만들어 냈으면 어 트레이닝을 실제로 진행을 해주면 되겠죠. 그래서 어 RPN 로스 그다음에 ROI 로스 두 가지 형태를 계산을 해줘서 최종적으로 이제 백워드를 해주게 되면은 모델이 학습이 가능하게 됩니다. 그래서 결론적으로 다시 말씀드리자면 여기서 정의한 크리에이터 과정은 인퍼런스 하는 데는 전혀 필요 없는 그런 모듈들이죠. 저희가 인퍼런스를 할 때는 위에서 정의한 이 패스트 알시에들만 필요하게 됩니다. 어 이것으로 패스트 알시에는 2강 시스 코드 강의를 마무리하도록 하겠습니다. 감사합니다. 네 이것으로 이제 프롬 스크래치로 패스트 CNN을 한번 구현해 봤는데요. 어려운 부분도 있고 상당히 복잡한 것도 있을 것 같습니다. 하지만 저희가 코드 셋을 나중에 제공해 드릴 생각이고 데일리 미션으로도 충분히 수행하실 수 있게끔 스켈레톤을 제공해 드릴 생각이기 때문에 이제 한 번쯤 직접 코드를 라이브로 구현해 보시는 것을 추천해 드립니다. 감사합니다."
}