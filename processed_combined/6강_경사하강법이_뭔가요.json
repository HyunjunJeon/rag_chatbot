{
  "lecture_name": "6강_경사하강법이_뭔가요",
  "source_file": "6강_경사하강법이_뭔가요_70.mp4_2025-12-04-103713190.json",
  "text": "네 안녕하세요 메스메릭스포 알티피셜 인텔레전스 6강 경사 하강법이 뭔가요를 강의하게 된 고려대학교 통계학과 임성빈입니다. 저희는 지난 시간까지 선형대수를 기초로 해서 벡터 행렬 그리고 텐서까지 활용하는 방법을 공부를 해 봤는데요. 이번 시간부터는 이제 미적분 캘큘러스라는 걸 이용을 해서 저희가 딥러닝의 학습에서 가장 근본적으로 사용이 되는 경사 하강법을 공부해 보도록 하겠습니다. 먼저 미분의 개념이 뭔지 살펴보려고 합니다. 미분이란 저희가 영어로는 디프랜젠션이라는 용어를 쓰고요. 기본적으로 변수의 움직임에 따른 함수 값의 변화를 측정하기 위한 도구로 네 최적화 과정에서 제일 많이 사용하는 기법 중 하나입니다. 아마 수학을 공부해 보신 분들은 미적분이란 말을 많이 들어보셨을 것 같은데요. 네 이번 시간에 배우는 거는 일단 기초적으로 1차 원 공간에서 사용하게 되는 미분의 개념을 한번 살펴보도록 하겠습니다. 먼저 수식을 좀 살펴보도록 할게요. 스는 저희가 어떤 숫자로 생각하시면 되고요 어 함수 f가 다음과 같이 주어져 있다고 하겠습니다. 이때 함수 f를 어 스에서 치 만큼 더해준 다음에 원래 함수 스에서의 함수 값을 빼주면은 치만큼 이동했을 때 함수 값의 변화량을 볼 수가 있게 됩니다. 그게 이제 분자에 들어가는 항이고요. 그다음에 정형에서 이동된 h만큼을 분모에서 나눠주게 됩니다. 이때 유의하실 점은 스랑 치랑 둘 다 숫자이기 때문에 네 분수를 계산하는 것이 가능하다라는 점 지금은 기억해 주시고요. 이때 치를 0으로 충분히 가까이 보냈을 때 그때의 극한값을 우리는 미분이라고 정의를 하게 됩니다. 그래서 미분이라 함은 x라는 점이 주어졌을 때 그 x라는 점에서의 순간적인 변화율을 우리가 얘기하는 것이고 미분은 그런 변화율을 x에 충분히 가까이 다가갔을 때의 극한으로 저희가 정리를 하게 되는 것입니다. 예시를 한번 살펴보도록 하겠습니다. 함수 프스를요 엑스 제곱 더하기 2 더하기 3이라는 2차 함수를 저희가 한번 정리를 해봤습니다. 이때 함수 에프를 저희가 한번 미분을 계산해 볼 건데요. 위에서 사용했던 프스 플러스 치 빼기 프스를 치로 나눈 값을 저희가 한번 계산을 해 보겠습니다. 저희가 수식을 한번 풀어서 계산을 해보게 되면은 ex 더하기 2 더하기 h라는 결과가 나오게 됩니다. 이때 미분이란 개념은 이 수식에서 h를 0으로 보내는 극한이라고 저희가 정리를 했었죠. 이때 ex 플러스 2 플러스 h를 그럼 0으로 h를 0으로 보내는 극한을 취해주게 되면은 h는 0으로 가고 남은 부분이 ex 플러스 2이기 때문에 이 함수 FX의 미분은 극한의 정의에 따라서 2x 플러스 2로 저희가 결론을 내리게 되는 것입니다. 그래서 미분을 저희가 계산을 하려면요. 사실은 이러한 정의에 따라서 일일이 치를 0으로 보내는 극한을 계산을 해야 되는 것입니다. 하지만 요즘에는 미분을 손으로 직접 계산하는 대신에 컴퓨터가 이런 계산들을 좀 직접적으로 해주는 걸 도와줄 수가 있는데요. 수치적으로 미분을 도와주는 뉴메리컬 디프레제이션 툴도 있지만 이렇게 기호로 표현되는 수식을 미분을 도와주는 함수들도 있습니다. 당연히 파이썬에서도 이런 것들을 제공해 주는데요. 이제 심블릭 디프레세이션을 지원한다고 해서 저희가 심파이라는 라이브러리를 사용하게 되는데 이 신 파일 안에 디아프프라는 함수를 가지고 미분을 저희가 손으로 계산하지 않아도 컴퓨터로 유도를 한번 해 볼 수가 있게 됩니다. 예시를 한번 살펴보시면요. 저희가 x 제곱 더하기 2x 더하기 3이라는 수식을 앞에서 사용했었는데요. 이거를 심파이에서 폴리노미로 인식을 하게 만들어 준 후에 그다음에 심파이에 다시 디아프 함수를 통해서 스에 대해서 미분하시오라고 저희가 지정을 해 주게 되면은 이렇게 이스 더하기 2라는 함수를 출력해 주게 됩니다. 이와 같이 저희가 어떤 좀 잘 알려진 함수들 같은 경우에는 우리가 손으로 직접 미분하지 않아도 컴퓨터를 통해서 계산을 할 수가 있기 때문에 여러분들께서 미분을 계산하실 때 어떤 개념적인 정의를 아시는 것도 필요하지만 이렇게 컴퓨터를 활용해서 미분을 계산할 수 있다는 부분도 기억하시면 되겠습니다. 네 앞선 페이지에서는 이제 미분의 수학적 정의와 그리고 심볼릭 파일을 이용해서 계산을 해보는 방법을 좀 살펴보았는데요. 숫자를 계산하는 것뿐만 아니라 미분의 개념을 한번 그림으로 이해해 보는 것도 굉장히 중요하겠습니다. 네 미분의 개념을 한번 기하학적으로 이해해 보기 위해서 저희가 한번 이렇게 그림을 그려봤습니다. 어떤 함수 f가 주어졌을 때 그 함수 f의 그래프를 표현할 때는 입력에 해당하는 x와 그리고 이 스를 함수 프에 넣었을 때 결과값 즉 함수 값을 이렇게 순서상으로 모으게 되면은 어 이 점들의 집합을 저희가 그래프라고 부릅니다. 그랬을 때 어떤 함수 프의 그래프를 그려보면은 이렇게 치로 나왔다고 하겠습니다. 일단 어떤 점 x가 이와 같이 이 하얀색 점을 x라고 하고 그 점에서의 함수 값을 x 콤마 FX FX라는 함수 값을 가지고 그 점을 이렇게 빨간색 점으로 표시를 한번 해 보았습니다. x 콤마 FX가 이 점인데요. 이때 앞에서 미분의 정의를 소개할 때 말씀을 드렸던 이 순간적인 기울기에 해당하는 FX 플러스 h 마이너스 프스분의 치를 한번 저희가 어떤 식으로 나오는지 보려고 합니다. 이때 이 치만큼 이동을 했기 때문에 스에서 h만큼 이동한 지점이 어디 있는지를 한번 보면요. 네 이 부분이 이제 스플러스치가 되겠습니다. 그렇다면 이 지점이 스 플러스 치고 이때 함수 값이 프스플러스치가 될 텐데요. 이 빨간 지점 이 FX 플러스 h를 함수 값으로 가진 이 빨간색 점과 그리고 x에서의 함수 값을 가지는 이 FX에서의 이 함수 값의 차이가 바로 이 식의 분자에 해당하는 것이고요. 그리고 x에서 h만큼 이동한 이 상대적 이동 거리인 h가 분모에 들어가서 우리가 치분의 프스 플러스 치마이너스 프스를 다음과 같이 계산을 할 수가 있는데 이 값은 이 빨간색 두 점을 이은 선분의 기울기가 되겠습니다. 그렇다면 미분의 정의라 함은 치를 0으로 보냈을 때 즉 다시 말해서 h를 0으로 보냈을 때 x 플러스 h는 점점 스로 가까이 다가가겠죠 그러면은 이 스 플러스h 콤마 프스 플러스 h는 이 초록색 함수 f의 그래프를 따라서 점점 x 콤마 FX로 향하게 됩니다. 그랬을 때 이 검은색 선분은 h가 0으로 갈수록 원래 스콤마 프스에서의 접선으로 향하게 되는 것이고 이때 미분은 이 해당 접선의 기울기로 향하게 되겠습니다. 네 그래서 h를 점점 0으로 보내면 다음과 같이 접선의 기울기로 수렴하는 모습을 보실 수가 있고요. 네 이렇게 h를 0으로 극한을 보냈을 때 극한값에 해당하는 것이 접선의 기울기가 되는 것이고 이거를 우리는 f 프라인 x라고 즉 함수 f의 x에서의 미분 값으로 우리가 정의를 하게 되는 것입니다. 이때 이 한 점에서의 접선의 기울기 값을 알면 이 지점에서 함수가 어느 방향으로 움직여야 함수 값이 증가하는지 또는 감소하는지 즉 함수의 그래프 측면에서 봤을 때 이 왼쪽으로 가면은 함수가 증가하는지 또는 오른쪽으로 가야 함수가 증가하는지를 미분 값을 통해서 알 수가 있게 됩니다. 즉 접선의 기울기가 0보다 크면 함수가 점점 증가하는 모양새가 되는 것이고요. 만약에 미분값이 0보다 작으면 즉 접선의 기울기가 0보다 작으면 이 함수는 감소하는 그래프다라고 우리가 이해할 수가 있겠습니다. 그래서 만약에 저희가 더 좋은 더 높은 함수 값을 만약에 찾고 싶다면은 어 이 미분 값을 토대로 어느 쪽으로 이동해야 되는지를 알 수가 있게 되는 것인데요. 지금 이 함수 f의 경우에는 x 지점에서의 접선의 기울기가 음수입니다. 그렇기 때문에 미분값이 음수인 경우인데 이 경우에는 오른쪽이 아니라 왼쪽으로 가야 네. 함수가 증가하는 방향이 되겠죠. 함수 값이 증가하는 방향이 될 테니까 우리는 미분 값을 토대로 어느 지점으로 이동해야 우리가 더 높은 함수 값을 찾을 수 있는지를 결정할 수가 있게 되는 것입니다. 따라서 함숫값을 증가할지 또는 감소시킬지를 알고 싶다면 우리가 미분 값을 토대로 함수 값이 증가하고 싶다면은 미분 값을 더하는 방향으로 보내주시면 되고 함수 값을 감소시키고 싶으면은 네 미분 값을 빼주는 방향으로 흐르면 됩니다. 정리해 보면 접선의 기울기가 음수이니까 이 경우에는 음수를 빼주면 더해주는 방향으로 가는 것이겠죠. 그러면 플러스 방향으로 가게 되는 거니까 함수가 감소하는 방향으로 가게 되는 것이고요. 만약에 미분 값을 더해주면은 이 경우에는 접선의 기울기가 음수니까 음수를 더해 주면 빼는 것이라서 왼쪽으로 가게 됩니다. 그러면은 이 함수는 점점 증가하는 방향으로 가는 것이죠. 이렇게 미분 값을 더해주면은 점점 증가하는 경향으로 가고 미분 값을 빼주면은 감소하는 방향으로 간다. 이 원리는 여러분이 잘 기억해 주시면 좋겠습니다. 네 그래서 미분값이 음수라서 엑스 플러스 에프프라임 스는 왼쪽으로 이동해서 이 경우에는 함수 값이 증가하게 되고 만약에 함수의 개형이 이렇게 생겨서요. 접선의 기울기가 이 지점에서 0보다 큰 경우에는 더해줬을 때 오른쪽으로 증가하는 방향으로 가야 함수값이 증가하겠죠. 네 이 지점에서는 접선의 기울기가 양수이기 때문에 더해줬을 때 우측으로 가는 방향으로 가게 되기 때문에 함수 f가 증가한다라는 거를 아실 수가 있게 됩니다. 거꾸로 저희가 미분 값을 빼면은 어떤 현상이 일어나는지 한번 살펴보도록 하겠습니다. 미분값이 음수인 경우에는 빼기 음수이니까 사실상 더해주는 즉 값을 더해주는 형태가 됩니다. 그러므로 이 경우에는 원래 지점보다 우측에 있기 때문에 오른쪽으로 이동해서 함수 값이 점점 감소하는 형태가 되는 것이고요. 만약에 이와 같이 어 함수의 특징이 접선의 기울기가 양수인 형태에서는 미분 값이 양수이기 때문에 이 지점에서 미분 값을 빼주게 되면은 왼쪽으로 이동하게 되므로 함수 값이 감소하는 방향이 됩니다. 따라서 우리가 미분 값을 더해주면 함수는 증가하고 미분 값을 빼주면 함수는 감소하는 방향으로 간다라는 사실을 기억하시면 좋겠습니다. 네 그래서 정리를 한번 해보겠습니다. 미분값을 더하면 우리가 그레디언트라는 이 용어를 쓰게 될 텐데요. 네 미분은 그레디언트라는 개념으로 여러분들이 기억해 주시면 좋을 거고요. 이때 미분 값을 더한다 즉 미분을 통해서 상승시킨다라고 여러분이 이해하시면 될 텐데 이거를 경사상승법이라고 합니다. 영어로는 그레디언트 어센트라고 부르게 됩니다. 이때 그레디언트 어센트를 통해서 우리는 함수 값을 점점 증가하는 방향으로 이동시킬 수가 있는데요. 즉 함수의 극대값의 위치를 구할 때 이 방법을 사용하게 됩니다. 즉 목적 함수를 x에 대해서 최대화하는 방향을 찾고 싶을 때 우리는 경사 상승법을 사용하게 됩니다. 하지만 이 강의의 제목은 경사 하강법이죠. 네 그렇다면 미분 값을 빼는 걸 우리는 사용한다라는 뜻이 되는데 네 경사 하강법은 말씀드린 대로 그레디언트 즉 미분을 빼주는 방향으로 함수 값을 최소화시키는 방향으로 우리는 사용하려고 하는 것입니다. 그래서 이거는 경사 하강법이라 하여 그레디언트 디센트라는 말을 쓰게 되고 이것은 우리가 함수의 극속값의 위치를 구할 때 사용하게 됩니다. 기계 학습 분야에서는 저희가 이제 손실 함수라는 용어를 쓰게 될 텐데 손실 함수는 값이 작을 때 우리가 원하는 목적을 달성할 수가 있어서 어 이 경우에는 경사 하강법을 쓰게 되는 것이고요. 만약에 우리가 목적식을 최대화 시켜야 되는 경우에서는 경사 하강법이 아니라 경사 상승법을 써야 된다는 사실을 여러분들 기억하시면 좋겠습니다. 한 가지 유의하실 점은 경사 상승법 그리고 경사 하강법 두 방법 모두 그 값에 도달하면 움직임이 멈춘다라는 거를 기억하셔야 됩니다. 그 값이라는 것은 바로 이 함수의 그래프가 어떤 접선의 기울기가 0이 되는 지점이 있습니다. 이 지점은 잘 보시면은 지금 이 함수의 경우에는 최댓값에 해당하는 경우라고 보실 수가 있긴 한데 이 곳에 도달하게 되면은 어 미분값이 0이기 때문에 더 이상 미분을 통해서 움직이지 않는 지점이 됩니다. 즉 그 값에서는 미분값이 0이 되므로 이 지점에 도달을 하게 되면은 더 이상 업데이트를 할 수가 없게 됩니다. 그러므로 목적 함수 최적화가 미분이 0이 되는 지점에서는 어 자동으로 멈추게 된다는 사실을 여러분이 경사 상승법 또는 경사 하강법에서 유의하셔야 될 부분이 되겠습니다. 이거는 함수가 최대인 지점을 찾는 경사 상승법이나 함수가 최소형 지점에 찾는 경사 하강법이나 둘 다 성립하게 되는 부분입니다. 경사 하강법을 저희가 한번 알고리즘으로 배워보도록 하겠습니다. 먼저 경사 하강법에서 필요한 입력에 해당하는 것이 뭔지를 한번 살펴볼 텐데요. 먼저 그레이디언트라는 입력을 일단 받게 되는데 이것은 뭐냐면은 미분을 계산하는 함수가 되겠습니다. 다시 말해서 어떤 함수 에프가 있을 때 그 함수 프에 입력 스에 해당하는 점에서의 미분 값을 계산해 주는 함수 그레디언트라는 함수가 필요합니다. 그리고 경사 하강법을 시작하게 되는 시작점 그리고 경사 하강법에서 미분 값을 얼마나 반영할지 사용하는 학습률 영어로는 러닝메이트라고 하는데요. 그리고 알고리즘 종료 조건 앱실론 이피스라고 하게 될 텐데 이 값들이 입력으로 먼저 필요하게 됩니다. 알고리즘을 하나하나씩 한번 살펴보도록 하겠습니다. 먼저 초기 조건으로 초기 시작 점 이닛을 우리가 배려블로 먼저 선언을 해 주고 그다음에 그 지점에서의 미분 값을 다음과 같이 그레드로 그레디언트 함수를 통해서 계산을 해 주게 됩니다. 그리고 경사 하강법의 경우에는 미분값이 0이 되기 직전까지 계속 움직이게 되는데요. 앞에서 계산한 미분값이 알고리즘 종료 조건보다 항상 큰 경우에는 즉 미분의 절대값이 항상 큰 경우에는 우리가 알고리즘을 계속 돌리겠다는 어 와일문을 선언해 줍니다. 왜 이렇게 설정을 해 주냐면은 저희가 컴퓨터의 경우에는 어떤 값이 정확히 0이다라고 밝혀내기가 쉽지 않기 때문에 그렇습니다. 그래서 미분이 정확히 0이 되는 것은 불가능하므로 이 종료 조건에 해당하는 충분히 작은 값보다 미분 값이 작을 때 알고리즘을 멈추겠다라고 저희가 스스로 종료하는 조건을 설정하는 것입니다. 네 그랬을 때 이 와 문 내에서요. 함수 f의 그레디언트를 계속 계산을 해 주게 되는데 지금 보시면은 우리가 앞서 선언했던 시작점에서 계산했던 그레디언트의 방향으로 이 변수를 움직여주는 코드가 이 박스를 친 부분입니다. 이때 러닝메이트 즉 합승률에 해당하는 상수를 우리가 그레디언트에 곱해줘서 빼주게 되죠. 즉 이 방법은 그레디언트를 빼주는 방법이니까 경사 하강법이 맞는 것이고 이렇게 초기 시작점을 움직여서 새로운 변수를 만들어 주고 그 새로운 변수에서 우리가 이제 그레이디언트를 또 계산하게 될 것입니다. 그래서 새로운 변수에서 이렇게 그레디언트를 계산을 해 준 다음에 그거를 가지고 넥스트 스텝에서 먼저 이 그레디언트가 충분히 작은지를 점검해 본 후에 다시 새로운 변수를 찾아서 업데이트하는 방식으로 미분 값을 계산하고 변수를 업데이트하고 이렇게 종료 조건이 성립하기 전까지 미분 값을 업데이트하는 방식으로 경사 하강법이 동작하게 됩니다. 네 그래서 앞서 살펴본 FX는 x 제곱 더하기 2x 더하기 3이라는 함수를 우리가 미분을 직접 계산해 보는 것도 해봤었죠. 이 함수 f의 경사 강법을 이용해서 최소점을 찾는 코드를 한번 이와 같이 설정을 해 보았습니다. 네 이렇게 알고리즘을 추상화해서 짠 코드를 넌 파일을 이용해서 한번 짜볼 수가 있는데요. 네 보시면은 어떤 시작점부터 출발을 해서 위에서 계산했던 즉 심플릭 파이로 계산했던 미분을 가져와 가지고 우리가 미분 값을 계산하는 함수와 그리고 변수를 업데이트하고 다시 미분을 계산하는 거를 한번 짜 보았습니다. 네 이런 식으로 우리가 경사 하강법을 돌렸을 때 보시면은 최소점이 어느 지점에 있는지를 정확하게 잘 찾는 거를 살펴보실 수가 있습니다. 네 그래서 이와 같이 경사 하강법을 저희가 쓰게 되면은 우리가 실제로 어떤 함수 f의 최솟값 지점을 우리가 효과적으로 알고리즘을 통해서 찾을 수 있게 됩니다. 이 경사 하강법 알고리즘을 통해서 우리가 실제로 딥러닝 학습 그리고 기계 학습 분야에서 많이 쓰이게 될 것인데요. 이 1차 함수에서의 경사 강법이 굉장히 중요한 원리를 가지고 있다라는 점을 기억해 두시면 좋겠습니다. 네 6강 경사 하강법을 한번 맞춰보았습니다. 다음 시간에는 좀 더 다차원 공간에서의 경사 하강법을 공부해 보도록 하겠습니다."
}